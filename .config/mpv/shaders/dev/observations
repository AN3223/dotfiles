#!/bin/sh -e
# vi: foldmethod=marker
### Here are some observations about the data gathered from shader_test. 
### Think of this kinda like a jupyter notebook. The format goes:
#
#{{{ Section start
### Command
#code
# OUTPUT:
# the code's output
#}}} Section end

### XXX test on different noise levels
### XXX test on softened noise
### XXX test temporal (including ME)

#{{{ Optimal non-local means 2x upscale (luma)
#
### Upscale w/ SKIP_PATCH=1:WD=0 (i.e., regular upscaler, no NLM)
#
#fn='max=SW=0.811199300207978:SS=1.3870308622552656_cfgopts=CFG_SIZE="2*":RF_LUMA=0:RF=0:R=7:RS=8:SK="sphinx_":WD=0:SKIP_PATCH=1_corruption=VF=scale=540:540_media=images.stats.bz2'
#bzcat "stats/$fn" | sort -k 2 -n | tail
#
# OUTPUT:
# BASELINE=VF=scale=540:540 0.927599
# SW=0.9756241983119647:SS=1.3800229899191112:CFG_SIZE=2*:RF_LUMA=0:RF=0:R=7:RS=8:SK=sphinx_:WD=0:SKIP_PATCH=1 0.9335504
#
### SKIP_PATCH=0 brings a minor improvement
#
#fn='max=S=16.90809288548364:SW=0.811199300207978:SS=1.3870308622552656_cfgopts=CFG_SIZE="2*":RF_LUMA="2*":RF=0:SF=3:PS=0:RI=7:R=7:RS=8:SK="sphinx_":WD=0_corruption=VF=scale=540:540_media=images.stats.bz2'
#bzcat "stats/$fn" | sort -k 2 -n | tail
#
# OUTPUT:
# BASELINE=VF=scale=540:540 0.927599
# S=16.790106011801686:SW=0.8439779133680052:SS=1.3845625416648042:CFG_SIZE=2*:RF_LUMA=2*:RF=0:SF=3:PS=0:RI=7:R=7:RS=8:SK=sphinx_:WD=0 0.9354282
#
#}}}

#{{{ Optimal non-local means (luma, P=3:R=5:PS=3:RS=3)
#
#fn='max=S=2.0522687499802097:SS=0.5296176863733414:SW=1.3011446081346498:WDT=0.11671341022864548_media=images.stats.bz2'
#bzcat "stats/$fn" | sort -k 2 -n | tail
#
# OUTPUT:
# BASELINE=NOISE=10:10 0.8704759
# S=2.0262062762852167:SS=0.5045657681048714:SW=1.3322924870317203:WDT=0.11832010376003192: 0.9575696
#
#}}}

#{{{ Optimal non-local means (luma, P=3:R=5:PS=4:RS=3:WD=1:RI=0:RFI=0:RF_LUMA=0)
#
### Suprisingly this performs almost as well as regular NLM
#
#fn='max=S=3.5968056672833097:SS=0.49764743714339127:SW=0.7392620481427672:WDT=0.580415381682815:WDP=5.381278367349288_cfgopts=PS=4:WD=1:RF=0:RF_LUMA=0:RI=0:RFI=0_media=images.stats.bz2'
#bzcat "stats/$fn" | sort -k 2 -n | tail
#
# OUTPUT:
# BASELINE=NOISE=10:10 0.8704759
# S=3.6280599151151334:SS=0.5072938692870894:SW=0.717967659498257:WDT=0.5509878334105431:WDP=5.402102275251726:PS=4:WD=1:RF=0:RF_LUMA=0:RI=0:RFI=0 0.9556407
#
#}}}

#{{{ Optimal non-local means (chroma, P=3:R=5:PS=3:RS=3:WD=1:RF=0)
#
#fn='max=S=5.191526541606411:SS=0.32091162692066677:SW=0.6448288408806067:WDT=0.913447511792627:WDP=5.832936323930807_cfgopts=WD=1:RF=0:RF_LUMA=0_plane=CHROMA_media=images.stats.bz2'
#bzcat "stats/$fn" | sort -k 2 -n | tail
#
# OUTPUT:
# BASELINE=NOISE=10:10 0.72809122
# S=5.100920322105462:SS=0.31580805565941705:SW=0.6429313578248627:WDT=0.9385150042004405:WDP=5.692202343435388:WD=1:RF=0:RF_LUMA=0 0.95800643
#
#}}}

#{{{ Optimal non-local means (chroma, P=3:R=5:PS=3:RS=3)
#
#fn='max=S=2.5168955531436197:SW=1.2219854377433914:SS=0.26295970436981203_plane=CHROMA_media=images.stats.bz2'
#bzcat "stats/$fn" | sort -k 2 -n | tail
#
# OUTPUT:
# BASELINE=NOISE=10:10 0.72809122
# S=2.356425745363608:SW=1.2033038941856653:SS=0.2660216669677905: 0.95838335
#
#}}}

#{{{ Optimal NLM LGC
#
#fn="NLM:images:CHROMA:NOISE=10:10:1080x1080:yuv444p:CAT=1:MAX=S:10:3:1e-6:10:RF='SHARE_LUMA':D1W=1:RI=3:RFI=2:WDT=0.0,0.25...1.5:SW=1.0,0.875,0.75:R=3,5,7.stats.bz2"
#bzcat "stats/$fn" | sort -k 2 -n | tail
#
# OUTPUT:
# S=8.888889:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.750000:SW=0.750000:R=7 0.9465736909
# S=8.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.250000:SW=1.000000:R=7 0.94704555455
# S=8.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.000000:SW=1.000000:R=7 0.94706957273
# S=8.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.500000:SW=1.000000:R=7 0.9471524091
# S=7.500000:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.250000:SW=0.875000:R=7 0.947231364
# S=7.222222:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.000000:SW=0.875000:R=7 0.947245964
# S=8.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.500000:SW=0.875000:R=7 0.94735124545
# S=7.222222:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.250000:SW=0.750000:R=7 0.9473976909
# S=7.222222:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.000000:SW=0.750000:R=7 0.9474485909
# S=8.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.500000:SW=0.750000:R=7 0.9475138727
#
#bzcat "stats/$fn" | grep -F :R=5 | sort -k 2 -n | tail
#
# OUTPUT:
# S=13.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.250000:SW=1.000000:R=5 0.93730393636
# S=13.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.000000:SW=1.000000:R=5 0.93733117273
# S=13.333333:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.500000:SW=0.875000:R=5 0.93767555455
# S=15.000000:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.750000:SW=0.875000:R=5 0.9376983
# S=12.222222:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.250000:SW=0.875000:R=5 0.93772519091
# S=12.777778:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.000000:SW=0.875000:R=5 0.9377606545
# S=12.500000:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.500000:SW=0.750000:R=5 0.9380457273
# S=15.000000:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.750000:SW=0.750000:R=5 0.9380642727
# S=11.666667:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.250000:SW=0.750000:R=5 0.93810337273
# S=11.666667:RF=SHARE_LUMA:D1W=1:RI=3:RFI=2:WDT=0.000000:SW=0.750000:R=5 0.938148545
#}}}

