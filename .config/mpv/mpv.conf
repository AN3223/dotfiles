# prefer closest resolution to 720p, prefer h265 > h264 > defaults
#ytdl-format=(bv*[vcodec^=hevc]/bv*[vcodec^=h265]/bv*[vcodec^=avc]/bv*[vcodec^=h264])+ba/bv*+ba/b
ytdl-raw-options=sponsorblock-mark=all,format-sort="res~720,fps~30",ignore-error=

# quality
hwdec=auto-copy-safe
prefetch-playlist=yes
profile=gpu-hq
scale=ewa_lanczossharp
dscale=ewa_lanczossharp
linear-downscaling=no
glsl-shaders='~~/shaders/FSR.glsl'

screenshot-directory=~/shots/
# %tc differs from date +%c so this is the equivalent for my locale
screenshot-template="%ta %td %tb %tY %tI:%tM:%tS %tp %tZ"
screenshot-sw=yes
screenshot-format=webp
screenshot-webp-lossless=yes
screenshot-webp-compression=6

save-position-on-quit
watch-later-options-remove=pause
audio-display=no
no-osc
no-keepaspect-window
keep-open=yes

slang=en,eng,english
alang=jp,jpn,japanese,en,eng,english
sub-font-size=30
no-sub-visibility
sub-auto=all
sub-file-paths=Subs

audio-channels=2
# some videos have horribly quiet audio, this tries to correct that
# but the result may sound pretty bad
# n is bound in input.conf to disable this
af=loudnorm=I=-10

[force-window]
profile-desc="Only do audio-display when force-window is set"
profile-cond=force_window ~= false
profile-restore=copy-equal
audio-display=embedded-first

[autoloop]
profile-desc="Loop playlist when certain conditions are met"
profile-cond=shuffle or (duration < 10 and playlist_count == 1)
profile-restore=copy-equal
loop-playlist=inf

[fastloop]
profile-desc="Faster looping for single files via loop-file"
profile-cond=loop_playlist == "inf" and playlist_count == 1
profile-restore=copy-equal
loop-file=inf

[subs]
profile-desc="Show subtitles based on audio language"
profile-cond=get("current-tracks/audio/lang"):find("^en") == nil
profile-restore=copy-equal
sub-visibility=yes

# https://artoriuz.github.io/blog/mpv_upscaling.html
# https://github.com/igv/FSRCNN-TensorFlow
# https://github.com/bjin/mpv-prescalers
# https://gist.github.com/agyild/82219c545228d70c5604f865ce0b0ce5
[0.9x]
profile-cond=current_window_scale<0.9
profile-restore=copy-equal
glsl-shader='~~/shaders/SSimDownscaler.glsl'
#[2x]
#profile-cond=current_window_scale>2 and current_window_scale<3
#profile-restore=copy-equal
#glsl-shaders='~~/shaders/FSR.glsl'
#[3x]
#profile-cond=current_window_scale>3 and current_window_scale<4
#profile-restore=copy-equal
#glsl-shaders='~~/shaders/FSR.glsl'
[LQ]
profile-desc="Resolution less than 1/5 of 1920x1080"
profile-cond=(width*height)<414720
profile-restore=copy-equal
glsl-shaders='~~/shaders/FSRCNNX_x2_16-0-4-1_enhance.glsl:~~/shaders/CAS-scaled.glsl:~~/shaders/KrigBilateral.glsl'

[image]
profile-desc="Image-specific options"
profile-cond=get("current-tracks/video/image")
profile-restore=copy-equal
sub-auto=no
term-status-msg=
no-stop-screensaver

[single-image]
profile-desc="Set image-display-duration=inf for single images"
profile-cond=get("current-tracks/video/image") and playlist_count == 1
image-display-duration=inf

[fastforward]
profile-restore=copy-equal
scale=bilinear
cscale=bilinear
dscale=bilinear
glsl-shaders=""
dither-depth=no
no-correct-downscaling
no-linear-downscaling
no-sigmoid-upscaling
deband=no
af=""
vf=""
vd-lavc-skiploopfilter=all
vd-lavc-skipframe=all

